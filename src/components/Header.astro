---
import { Icon } from 'astro-icon/components'

const items = [
  {
    url: '#about',
    name: 'About'
  },
  {
    url: '#careers',
    name: 'Careers'
  },
  {
    url: '#events',
    name: 'Events'
  },
  {
    url: '#products',
    name: 'Products'
  },
  {
    url: '#support',
    name: 'Support'
  },
]
---

<header id="header" class="fixed top-0 left-0 z-50 w-full py-9 px-6 transition-[background-color,_padding] md:py-16">
  <div class="flex justify-between items-center max-w-container mx-auto">
    <a data-id="link" href="#">
      <Icon class="w-36 h-auto md:w-48" name="logo" />
    </a>
    <input class="peer hidden"type="checkbox" name="menu" id="menu">
    <nav class="absolute top-0 left-0 -z-50 flex items-center w-full min-h-screen py-24 px-6 bg-black opacity-0 pointer-events-none transition-opacity peer-checked:opacity-100 peer-checked:pointer-events-auto sm:static sm:z-auto sm:size-auto sm:min-h-[auto] sm:bg-transparent sm:p-0 sm:opacity-100 sm:pointer-events-auto">
      <ul class="flex flex-col gap-y-4 uppercase text-2xl text-white sm:flex-row sm:gap-x-8 sm:font-alata-regular sm:normal-case sm:text-sm md:gap-x-10">
        {items.map(({ name, url }) => (
          <li><a data-id="link" class="relative after:absolute after:left-0 after:bottom-0 after:w-0 after:h-px after:bg-white after:transition-[width] hover:after:w-full sm:after:-bottom-1.5" href={url}>{name}</a></li>
        ))}
      </ul>
    </nav>
    <label class="cursor-pointer peer-checked:[&>.hamburger]:hidden peer-checked:[&>.close]:block sm:hidden" for="menu">
      <Icon class="hamburger" name="icon-hamburger" />
      <Icon class="close hidden size-5" name="icon-close" />
    </label>
  </div>
</header>

<script>
  const header = document.querySelector('#header')
  const input = document.querySelector('#menu')
  const links = document.querySelectorAll('[data-id="link"]')
  const className = 'md:py-5 bg-black'.split(' ')
  
  if (header instanceof HTMLElement) window.addEventListener('scroll', () => {
    if (window.scrollY > window.innerHeight/2) {
      header.classList.add(...className)
    } else {
      header.classList.remove(...className)
    }
  })

  links.forEach((link) => {
    if (link instanceof HTMLAnchorElement) {
      link.addEventListener('click', () => {
        if (input instanceof HTMLInputElement) {
          document.documentElement
          input.checked = false
        }
      })
    }
  })
</script>
